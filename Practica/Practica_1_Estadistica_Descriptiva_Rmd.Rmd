---
title: "Práctica de nutrición"
author: "Alejandro Hernández, Carlos Martínez, Daniel Corbacho, Iván Palacios, Pablo Romero, Paula Ortiz "
output: html_document
date: "Estadística 2024-09-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message=FALSE,
                      warning=FALSE)
```

```{r}
FastFoodNutritionMenuV2 <- read.csv('FastFoodNutritionMenuV2.csv')
FastFoodNutritionMenuV2$Calories <- as.numeric(FastFoodNutritionMenuV2$Calories)
FastFoodNutritionMenuV2$Total.Fat..g. <- as.numeric(FastFoodNutritionMenuV2$Total.Fat..g.)
FastFoodNutritionMenuV2$Cholesterol..mg. <- as.numeric(FastFoodNutritionMenuV2$Cholesterol..mg.)
FastFoodNutritionMenuV2$Sodium...mg. <- as.numeric(FastFoodNutritionMenuV2$Sodium...mg.)
FastFoodNutritionMenuV2$Carbs..g. <- as.numeric(FastFoodNutritionMenuV2$Carbs..g.)
FastFoodNutritionMenuV2$Fiber..g. <- as.numeric(FastFoodNutritionMenuV2$Fiber..g.)
FastFoodNutritionMenuV2$Sugars..g. <- as.numeric(FastFoodNutritionMenuV2$Sugars..g.)
FastFoodNutritionMenuV2$Protein..g. <- as.numeric(FastFoodNutritionMenuV2$Protein..g.)
```

Se lee el fichero y se convierte a datos numéricos las filas con las que se va a realizar los análisis. Esta conversión se debe a que el fichero se lee como cadena de caracteres y lo corregimos a datos numéricos.

# Introducción y definición de objetivos

El documento FastFoodNutritionMenuV2.csv contiene una lista de los resultados de distintos valores nutricionales obtenidos en distintos productos de diferentes marcas de comida rápida.
El objetivo de este estudio es determinar cuál de todos los productos analizados es el más dañino para la salud de las personas, así como la compañía con los peores productos.

# Importación de datos y carga de paquetes

En primer lugar, se precisa de la instalación de diversas librerías de "R" para llevar a cabo nuestro análisis descriptivo.

```{r}

library(tidyverse)
library(summarytools)
library(GGally)
library(gt)
library(flextable)
library(knitr)
library(corrplot)
library(dplyr)
```

Se proseguirá con la descarga y lectura del fichero que se va a estudiar en este proyecto.  

# Diccionario de datos

*`Company`: Compañía distribuidora del producto 

*`Item`: Nombre del producto 

*`Calories`: calorías totales del producto (kcal) 

*`Fat`: Grasas totales del producto (g) 

*`Cholesterol`: Colesterol total del producto (mg) 

*`Sodium`: Sodio total del producto (mg) 

*`Carbs`: Carbohidratos totales del producto (g) 

*`Fiber`: Fibra total del producto (g) 

*`Sugars`: Azúcares totales del producto (g) 

*`Protein`: Proteina total del producto (g) 


# Muestra del dataset

Ahora, se va a mostrar los primeros 10 elementos de la lista total de datos.



```{r}
FastFoodNutritionMenuV2|>
slice_head(n=10)|>
gt()
```




# Análisis exploratorio de datos

Se procederá a visionar el análisis exploratorio de datos (EDA) para obtener una conclusión sobre la muestra de datos obtenida.

## Datos univariantes

Se va a empezar analizando los datos univariantes que nos permitirá comprender la distribución y frecuencia de cada variable.

### Tablas de frecuencias

Se va a mostrar las tablas de frecuencia para entender mejor la distribución de nuestras variables.


Se comenzará con la variabla"Company", para observar cómo se distribuyen las compañías de la muestra de datos.
Tabla para la variable "Company":

```{r}
tabla_frecuencia <-FastFoodNutritionMenuV2 |>
  count(Company)|> 
  mutate(f = n/nrow(FastFoodNutritionMenuV2),
         N = cumsum(n),
         F = cumsum(f))
knitr::kable(tabla_frecuencia, digits = 4)
```

Para una mejor representación, se realiza un gráfico de barras con las frecuencias relativas. Así, se podrá apreciar de una forma más sencilla.

```{r}
FastFoodNutritionMenuV2  |> group_by(Company) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), Company = reorder(Company, -Frequency)) |> ggplot(aes(x = Company, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de las compañías", x = "Nombre de la compañía", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "green", high = "cyan") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

A continuación se realiza otro gráfico con las frecuencias absolutas.

```{r}
FastFoodNutritionMenuV2 |>
  group_by(Company) |>
  summarise(Frequency = n()) |>
  mutate(Company = reorder(Company, -Frequency)) |>
  ggplot(aes(x = Company, y = Frequency)) +
  geom_bar(stat = "identity", aes(fill = Frequency)) +
  theme_bw() +
  labs(title = "Gráfico de barras con frecuencia absoluta de la compañía",
       x = "Nombre de la compañía", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "green", high = "cyan") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Datos bivariantes

Ahora se procede a estudiar que compañia es la más perjudicial a partir del estudio de sus diferentes valores.

Se comienzará haciendo la media de las calorías de los productos de cada compañía. Resultando el siguiente gráfico de barras:

```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x=Company, y=Calories))+geom_boxplot()+theme_bw()

```

Como se puede observar, la compañía más calórica es Burguer King, y la menos calórica KFC. 

Ahora se procede a analizar un gráfico de densidad de las calorías de los productos. 

```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x = Calories, fill = Company)) + geom_density(alpha = 0.5)+labs(title = "Gráfico de densidad del número de calorías", 
       x = "Calorías (kcal)",
       y = "Densidad")+theme_bw()
```

Se observa en el gráfico que Pizza Hut concentra la mayoría de sus productos en torno a 250 calorías. Además Burguer King vuelve a mostrar que es la compañía con la concentración de productos más calóricos.

Se proseguirá haciendo la media de las grasas de los productos de cada compañía. Dando como resultado el siguiente gráfico de barras:

```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x=Company, y=Total.Fat..g.))+geom_boxplot()+theme_bw()
```

Burguer King es la compañía con la mayor media de grasas y KFC es la compañía con la media menor.Sin embargo, Taco Bell tiene gran cantidad de grasas en sus productos.

Ahora se estudiará el gráfico de densidades de las grasas de los productos.

```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x = Total.Fat..g., fill = Company)) + geom_density(alpha = 0.5)+labs(title = "Gráfico de densidad de los gramos de grasas", 
       x = "Grasas (g)",
       y = "Densidad")+theme_bw()
```

La mayoría de los productos se concentran en menos de 25 gramos de grasa y de los productos que superan ese límite, Burguer King es el que más productos posee.

A continuación se muestra el gráfico de colesterol medio de cada compañía.

```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x=Company, y=Cholesterol..mg.))+geom_boxplot()+theme_bw()
```

Como se observa, la compañía con mayor colesterol es Taco Bell y la que menos tiene es KFC.