---
title: "Práctica de nutrición"
author: "Alejandro Hernández, Carlos Martínez, Daniel Corbacho, Iván Palacios, Pablo Romero, Paula Ortiz "
output: html_document
date: "Estadística 2024-09-27"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message=FALSE,
                      warning=FALSE)
```


# Importación de datos y carga de paquetes


En primer lugar, se precisa de la instalación de diversas librerías de "R" para llevar a cabo nuestro análisis descriptivo.


```{r}

library(tidyverse)
library(summarytools)
library(GGally)
library(gt)
library(flextable)
library(knitr)
library(corrplot)
library(dplyr)
```

  
```{r}
FastFoodNutritionMenuV2 <- read.csv('FastFoodNutritionMenuV2.csv')
FastFoodNutritionMenuV2$Calories <- as.numeric(FastFoodNutritionMenuV2$Calories)
FastFoodNutritionMenuV2$Total.Fat..g. <- as.numeric(FastFoodNutritionMenuV2$Total.Fat..g.)
FastFoodNutritionMenuV2$Cholesterol..mg. <- as.numeric(FastFoodNutritionMenuV2$Cholesterol..mg.)
FastFoodNutritionMenuV2$Sodium...mg. <- as.numeric(FastFoodNutritionMenuV2$Sodium...mg.)
FastFoodNutritionMenuV2$Carbs..g. <- as.numeric(FastFoodNutritionMenuV2$Carbs..g.)
FastFoodNutritionMenuV2$Fiber..g. <- as.numeric(FastFoodNutritionMenuV2$Fiber..g.)
FastFoodNutritionMenuV2$Sugars..g. <- as.numeric(FastFoodNutritionMenuV2$Sugars..g.)
FastFoodNutritionMenuV2$Protein..g. <- as.numeric(FastFoodNutritionMenuV2$Protein..g.)
FastFoodNutritionMenuV2$Saturated.Fat..g. <- as.numeric(FastFoodNutritionMenuV2$Saturated.Fat..g.)

```

Se lee el fichero y se convierte a datos numéricos las filas con las que se va a realizar los análisis. Esta conversión se debe a que el fichero se lee como cadena de caracteres y lo corregimos a datos numéricos.


# Introducción y definición de objetivos


El documento FastFoodNutritionMenuV2.csv contiene los resultados de distintos valores nutricionales obtenidos en diferentes productos de varias compañías de comida rápida.


El objetivo de este estudio es determinar a partir de los valores nutricionales recogidos, la compañía con los productos más perjudiciales para la salud. Para ello se estudiarán varias categorías de relevancia alimenticia, como por ejemplo las grasas, la proteína, el azúcar, el colesterol... Con estos datos, se podrá confirmar cuál de las compañías es la más perjudicial para la salud. Además se tratarán de responder a las siguientes preguntas:

¿Cuál es la compañía más perjudicial?

¿Qué compañía es la que más grasa, proteína, calorías, azúcar tiene?

¿Existe alguna relación entre alguno de los valores nutricionales como la grasa y la proteína?


# Diccionario de datos


Los datos que se van a estudiar corresponden a las siguientes variables. No obstante, hay algunos valores que no se van a analizar debido a que no presentan gran información relevante para el estudio o simplemente porque no encajan con los objetivos de este.


Variables que no se tendrán en cuenta: Calories.from.Fat, Trans.Fat, Weight.Watchers.Pnts.


Variables que sí se tendrán en cuenta en el estudio (nombradas por su nombre en el fichero, descripción, unidades si las tiene y tipo de dato):


* `Company`: Nombre de la compañía distribuidora del producto (cualitativo, nominal)

* `Item`: Nombre del producto, se relaciona con company (cualitativo, nominal)

* `Calories`: Calorías totales del producto (kcal) (cuantitativo, continuo)

* `Total.Fat..g.`: Grasas totales del producto (g) (cuantitativo, continuo)

* `Saturated.Fat..g.`: Grasas saturadas totales del producto (g) (cuantitativo, continuo)

* `Cholesterol..mg.`: Colesterol total del producto (mg) (cuantitativo, continuo)

* `Sodium...mg.`: Sodio total del producto (mg) (cuantitativo, continuo)

* `Carbs..g.`: Carbohidratos totales del producto (g) (cuantitativo, continuo)

* `Fiber..g.`: Fibra total del producto (g) (cuantitativo, continuo)

* `Sugars..g.`: Azúcares totales del producto (g) (cuantitativo, continuo)

* `Protein..g.`: Proteina total del producto (g) (cuantitativo, continuo)


# Muestra del dataset


Ahora, se va a mostrar los primeros 10 elementos de la lista total de datos, para entender mejor cómo esta estructurada la información con la que se va a trabajar.



```{r}
FastFoodNutritionMenuV2|>
slice_head(n=10)|>
gt()
```


# Análisis exploratorio de datos


Se procederá a realizar el análisis exploratorio de datos (EDA) para obtener una conclusión sobre la muestra de datos obtenida.

## Datos univariantes


Se va a empezar analizando los datos univariantes que nos permitirá comprender la distribución y frecuencia de cada variable. Tras ello, se podrá entender mejor como está repartida cada variable.


### Company


Se comenzará con la variable "Company", para observar cómo se distribuyen las compañías de la muestra de datos.

Tabla para la variable "Company":


```{r}
tabla_frecuencia_Company <-FastFoodNutritionMenuV2 |>
  count(Company)|> 
  mutate(f = n/nrow(FastFoodNutritionMenuV2))

print(tabla_frecuencia_Company, digits = 4) 
```

La tabla de frecuencia anterior muestra el número total de productos recogidos de cada compañía. En esta se observa McDonald's es la compañía de la que se ha recogido más datos (28.66 %) y Pizza Hut la que menos (6.45 %).

Para una mejor representación, se realizará un gráfico de barras con las frecuencias relativas. Así, se podrá apreciar de una forma más sencilla la información.

```{r}
FastFoodNutritionMenuV2  |> group_by(Company) |>  summarise(Frequency = n()) |> mutate(Frequency = Frequency/sum(Frequency), Company = reorder(Company, -Frequency)) |> ggplot(aes(x = Company, y = Frequency)) + geom_bar(stat = "identity", aes(fill = Frequency)) + scale_y_continuous(labels = scales::percent) + theme_bw() + labs(title = "Gráfico de barras con frecuencia relativa de las compañías", x = "Nombre de la compañía", y = "Frecuencia relativa") + scale_fill_gradient("Frecuencia", low = "green", high = "cyan") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Como ya se ha visto anteriormente, McDonald's es la compañía con mayor porcentaje de productos y Pizza Hut la que menos.

A continuación, se realiza con la misma información un gráfico de frecuencias absolutas.


```{r}
FastFoodNutritionMenuV2 |>
  group_by(Company) |>
  summarise(Frequency = n()) |>
  mutate(Company = reorder(Company, -Frequency)) |>
  ggplot(aes(x = Company, y = Frequency)) +
  geom_bar(stat = "identity", aes(fill = Frequency)) +
  theme_bw() +
  labs(title = "Gráfico de barras con frecuencia absoluta de la compañía",
       x = "Nombre de la compañía", y = "Frecuencia absoluta") + scale_fill_gradient("Frecuencia", low = "green", high = "cyan") + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Los datos indican que los productos analizados de McDonald's son 329 productos y de Pizza Hut son 74 productos.



Una vez comprendida la distribución de las compañías, se realizan las tablas necesarias para comprender cada variable cuantitativa empezando por las calorías. Con ello, se podrá analizar cuál es el intervalo en el que se encuentra la mayoría de los productos de todas las compañías. Y de este modo, se podrán resolver algunas de las dudas planteadas en la introducción.





### Calorías




Gráfico por intervalos de calorías:


```{r}
histo <- hist(FastFoodNutritionMenuV2$Calories, plot = FALSE)

FastFoodNutritionMenuV2 <- FastFoodNutritionMenuV2 |>
  mutate(Intervalo_de_calorias = cut(Calories, breaks = histo$breaks))

tabla_frecuencias_Calories <- FastFoodNutritionMenuV2 |>
  group_by(Intervalo_de_calorias) |>
  summarise(n = n(), f = n() / nrow(FastFoodNutritionMenuV2)) |>
  mutate(N = cumsum(n), F = cumsum(f))

tabla_frecuencias_Calories <- tabla_frecuencias_Calories |>
  arrange(Intervalo_de_calorias) |>
  kable(digits = 4)

print(tabla_frecuencias_Calories, digits = 4)
```



Como se observa, el intervalo más frecuente es (100,200] kcal. Sin embargo hay 98 elementos que tienen valores nulos, esto afectará a posteriores gráficos.




```{r}

FastFoodNutritionMenuV2 |> ggplot(aes(Calories)) +
  geom_histogram(fill = "cyan", bins = 15, col = "white") + labs(title = "Histograma de las calorías",
       x = "Intervalos de las calorías", y = "Frecuencia") +
  theme_bw()
```

La mayoría de productos tienen alrededor de 225 kcal, lo que concuerda con lo obtenido anteriormente.


### Grasas



Gráfico por intervalos de grasas:

```{r}
histo <- hist(FastFoodNutritionMenuV2$Total.Fat..g., plot = FALSE)

FastFoodNutritionMenuV2 <- FastFoodNutritionMenuV2 |>
  mutate(Intervalo_de_grasas = cut(Total.Fat..g., breaks = histo$breaks))

tabla_frecuencias_Fat <- FastFoodNutritionMenuV2 |>
  group_by(Intervalo_de_grasas) |>
  summarise(n = n(), f = n() / nrow(FastFoodNutritionMenuV2)) |>
  mutate(N = cumsum(n), F = cumsum(f))

tabla_frecuencias_Fat <- tabla_frecuencias_Fat |>
  arrange(Intervalo_de_grasas) |>
  kable(digits = 4)

print(tabla_frecuencias_Fat, digits = 4)

```


La mayoría de los productos tienen de 0 a 10 gramos de grasas. Hay gran cantidad de datos nulos, de hecho hay un 37% de datos nulos.




```{r}

FastFoodNutritionMenuV2 |> ggplot(aes(Total.Fat..g.)) +
  geom_histogram(fill = "cyan", bins = 15, col = "white") + labs(title = "Histograma de las grasas",
       x = "Intervalos de las grasas", y = "Frecuencia") +
  theme_bw()
```

La mayoría de productos tienen alrededor de 13 gramos de grasas. Además se vuelve a mostrar gran cantidad de valores nulos. 


### Grasas Saturadas



Gráfico por intervalos de grasas saturadas:


```{r}
histo <- hist(FastFoodNutritionMenuV2$Saturated.Fat..g., plot = FALSE)

FastFoodNutritionMenuV2 <- FastFoodNutritionMenuV2 |>
  mutate(Intervalo_de_saturadas = cut(Saturated.Fat..g., breaks = histo$breaks))

tabla_frecuencias_Saturated <- FastFoodNutritionMenuV2 |>
  group_by(Intervalo_de_saturadas) |>
  summarise(n = n(), f = n() / nrow(FastFoodNutritionMenuV2)) |>
  mutate(N = cumsum(n), F = cumsum(f))

tabla_frecuencias_Saturated <- tabla_frecuencias_Saturated |>
  arrange(Intervalo_de_saturadas) |>
  kable(digits = 4)

print(tabla_frecuencias_Saturated, digits = 4)

```


De 2 a 4 gramos de grasas saturadas, es lo más frecuente. Teniendo en cuenta que el intervalo de grasas más repetido es (0,10], tiene sentido que las grasas saturadas tengan un intervalo menor. Si realizamos la suma de todos los intervalos que entrarían en el de las grasas, da como resultado un 50.96% de los productos totales analizados.



```{r}

FastFoodNutritionMenuV2 |> ggplot(aes(Saturated.Fat..g.)) +
  geom_histogram(fill = "cyan", bins = 15, col = "white") + labs(title = "Histograma de las grasas saturadas",
       x = "Intervalos de las grasas saturadas", y = "Frecuencia") +
  theme_bw()
```

La mayoría de productos tienen alrededor de 4 gramos de grasas saturadas, a medida que se aumenta los gramos, disminuye la cantidad de productos que se encuentran. 


### Colesterol



Gráfico por intervalos de colesterol:

```{r}
histo <- hist(FastFoodNutritionMenuV2$Cholesterol..mg., plot = FALSE)

FastFoodNutritionMenuV2 <- FastFoodNutritionMenuV2 |>
  mutate(Intervalo_de_colesterol = cut(Cholesterol..mg., breaks = histo$breaks))

tabla_frecuencias_Cholesterol <- FastFoodNutritionMenuV2 |>
  group_by(Intervalo_de_colesterol) |>
  summarise(n = n(), f = n() / nrow(FastFoodNutritionMenuV2)) |>
  mutate(N = cumsum(n), F = cumsum(f))

tabla_frecuencias_Cholesterol <- tabla_frecuencias_Cholesterol |>
  arrange(Intervalo_de_colesterol) |>
  kable(digits = 4)

print(tabla_frecuencias_Cholesterol, digits = 4)
```

El colesterol es un valor que hay que tener muy en cuenta para llevar una buena vida saludable. El intervalo más frecuente es de 0 a 50 mg. Es un valor no muy alto porque los expertos recomiendan menos de 300 mg/día, pero es preocupante que existan productos que superen ese límite.



```{r}

FastFoodNutritionMenuV2 |> ggplot(aes(Cholesterol..mg.)) +
  geom_histogram(fill = "cyan", bins = 15, col = "white") + labs(title = "Histograma de las Colesterol",
       x = "Intervalos de las Colesterol", y = "Frecuencia") +
  theme_bw()
```

La mayoría de productos tienen alrededor de 50 mg de colesterol. Hay algún valor que se acerca a 600 mg, lo que supone una cantidad excesiva de colesterol en un solo producto.


### Sodio



Gráfico por intervalos de sodio:

```{r}
histo <- hist(FastFoodNutritionMenuV2$Sodium...mg., plot = FALSE)

FastFoodNutritionMenuV2 <- FastFoodNutritionMenuV2 |>
  mutate(Intervalo_de_sodio = cut(Sodium...mg., breaks = histo$breaks))

tabla_frecuencias_Sodium <- FastFoodNutritionMenuV2 |>
  group_by(Intervalo_de_sodio) |>
  summarise(n = n(), f = n() / nrow(FastFoodNutritionMenuV2)) |>
  mutate(N = cumsum(n), F = cumsum(f))

tabla_frecuencias_Sodium <- tabla_frecuencias_Sodium |>
  arrange(Intervalo_de_sodio) |>
  kable(digits = 4)

print(tabla_frecuencias_Sodium, digits = 4)
```

De 0 a 200 mg es el intervalo más frecuente en el sodio. Los expertos recomiendan por día para un adulto 2000 mg y para niños 1500mg. De este modo el sodio está dentro del límite recomendado y es muy raro que un producto de los analizados supere ese límite.



```{r}

FastFoodNutritionMenuV2 |> ggplot(aes(Sodium...mg.)) +
  geom_histogram(fill = "cyan", bins = 15, col = "white") + labs(title = "Histograma de las Sodio",
       x = "Intervalos de las Sodio", y = "Frecuencia") +
  theme_bw()
```

La mayoría de productos tienen alrededor de 300 mg de sodio, y la cantidad de productos disminuye cuando se aumenta los mg de sodio.


### Carbohidratos



Gráfico por intervalos de carbohidratos:


```{r}
histo <- hist(FastFoodNutritionMenuV2$Carbs..g., plot = FALSE)

FastFoodNutritionMenuV2 <- FastFoodNutritionMenuV2 |>
  mutate(Intervalo_de_carbohidratos = cut(Carbs..g., breaks = histo$breaks))

tabla_frecuencias_Carbs <- FastFoodNutritionMenuV2 |>
  group_by(Intervalo_de_carbohidratos) |>
  summarise(n = n(), f = n() / nrow(FastFoodNutritionMenuV2)) |>
  mutate(N = cumsum(n), F = cumsum(f))

tabla_frecuencias_Carbs <- tabla_frecuencias_Carbs |>
  arrange(Intervalo_de_carbohidratos) |>
  kable(digits = 4)

print(tabla_frecuencias_Carbs, digits = 4)


```


El intervalo más frecuente de carbohidratos es de (20,40] g. Lo recomendable es 135 gramos para una persona y 175 gramos para embarazadas. Los carbohidratos están dentro de los límites en la mayoría de compañías.




```{r}

FastFoodNutritionMenuV2 |> ggplot(aes(Carbs..g.)) +
  geom_histogram(fill = "cyan", bins = 15, col = "white") + labs(title = "Histograma de las carbohidratos",
       x = "Intervalos de las carbohidratos", y = "Frecuencia") +
  theme_bw()
```

La mayoría de productos tienen alrededor de 40 gramos de carbohidratos, lo que está dentro de lo recomendado al día.





#### Fibra




Gráfico por intervalos de fibra:


```{r}
histo <- hist(FastFoodNutritionMenuV2$Fiber..g., plot = FALSE)

FastFoodNutritionMenuV2 <- FastFoodNutritionMenuV2 |>
  mutate(Intervalo_de_fibra = cut(Fiber..g., breaks = histo$breaks))

tabla_frecuencias_Fiber <- FastFoodNutritionMenuV2 |>
  group_by(Intervalo_de_fibra) |>
  summarise(n = n(), f = n() / nrow(FastFoodNutritionMenuV2)) |>
  mutate(N = cumsum(n), F = cumsum(f))

tabla_frecuencias_Fiber <- tabla_frecuencias_Fiber |>
  arrange(Intervalo_de_fibra) |>
  kable(digits = 4)

print(tabla_frecuencias_Fiber, digits = 4)

```


De 0 a 2 gramos es lo más frecuente en la fibra y lo recomendable son de 20 a 35 gramos. Si comprobamos todos los productos que estén dentro de ese intervalo, el 100% de los productos lo cumplen. Así que respecto a la fibra, todas las compañías respetan los límites establecidos.




```{r}

FastFoodNutritionMenuV2 |> ggplot(aes(Fiber..g.)) +
  geom_histogram(fill = "cyan", bins = 15, col = "white") + labs(title = "Histograma de la fibra",
       x = "Intervalos de las fibra", y = "Frecuencia") +
  theme_bw()
```

Si no se tiene en cuenta los valores nulos, lo más común son 3 gramos de fibra.


#### Azúcar



Gráfico por intervalos de azúcar:

```{r}
histo <- hist(FastFoodNutritionMenuV2$Sugars..g., plot = FALSE)

FastFoodNutritionMenuV2 <- FastFoodNutritionMenuV2 |>
  mutate(Intervalo_de_azucar = cut(Sugars..g., breaks = histo$breaks))

tabla_frecuencias_Sugars <- FastFoodNutritionMenuV2 |>
  group_by(Intervalo_de_azucar) |>
  summarise(n = n(), f = n() / nrow(FastFoodNutritionMenuV2)) |>
  mutate(N = cumsum(n), F = cumsum(f))

tabla_frecuencias_Sugars <- tabla_frecuencias_Sugars |>
  arrange(Intervalo_de_azucar) |>
  kable(digits = 4)

print(tabla_frecuencias_Sugars, digits = 4)

```


El azúcar es un valor a tener en cuenta. Es el principal responsable del sobrepeso y ha de tomarse en cantidades adecuadas. Lo que se recomienda es de 50 a 60 gramos en adultos y 30 a 35 en niños. El intervalo más frecuente es de 0 a 20 gramos, lo que entra dentro de los límites. Si miramos los productos que podría tomar un adulto, estos nos salen un 68.64% de ellos. Sin embargo, los niños solo podrían tomar menos del 57.06% de estos.



```{r}

FastFoodNutritionMenuV2 |> ggplot(aes(Sugars..g.)) +
  geom_histogram(fill = "cyan", bins = 15, col = "white") + labs(title = "Histograma de las azúcar",
       x = "Intervalos de las azúcar", y = "Frecuencia") +
  theme_bw()
```

Unos 30 gramos de azúcar es lo que más se repite en el histograma, lo que supondría aproximadamente un 60% del azúcar total recomendable al día.


#### Proteína



Gráfico por intervalos de proteína:


```{r}
histo <- hist(FastFoodNutritionMenuV2$Protein..g., plot = FALSE)

FastFoodNutritionMenuV2 <- FastFoodNutritionMenuV2 |>
  mutate(Intervalo_de_proteinas = cut(Protein..g., breaks = histo$breaks))

tabla_frecuencias_Protein <- FastFoodNutritionMenuV2 |>
  group_by(Intervalo_de_proteinas) |>
  summarise(n = n(), f = n() / nrow(FastFoodNutritionMenuV2)) |>
  mutate(N = cumsum(n), F = cumsum(f))

tabla_frecuencias_Protein <- tabla_frecuencias_Protein |>
  arrange(Intervalo_de_proteinas) |>
  kable(digits = 4)

print(tabla_frecuencias_Protein, digits = 4)

```


El intervalo más frecuente es de 5 a 10 gramos de proteína. Lo recomendable es 0.8 gramos por cada kilo de peso. Suponiendo que un hombre promedio pesa 77.5 kilos y una mujer promedio 63.5 kilos, serían 62 gramos y 50.8 gramos respectivamente. De este modo las proteínas respetan el límite predefinido.


```{r}

FastFoodNutritionMenuV2 |> ggplot(aes(Protein..g.)) +
  geom_histogram(fill = "cyan", bins = 15, col = "white") + labs(title = "Histograma de las proteína",
       x = "Intervalos de las proteína", y = "Frecuencia") +
  theme_bw()
```

La mayoría de productos tienen alrededor de 15 gramos de proteína, lo que está dentro de los límites recomendados.


### Resumen Numérico
Para acabar con el estudio univariante, se hará un resumen numérico comparando los valores de todas las variables

```{r}
FastFoodNutritionMenuV2 |> select(Calories, Total.Fat..g., Saturated.Fat..g.,  Cholesterol..mg., Sodium...mg., Carbs..g., Fiber..g., Sugars..g., Protein..g.) |> descr() 
```

## Datos bivariantes


Se proseguirá haciendo diferentes gráficos para entender las relaciones entre las distintas variables cuantitativas y cualitativas.


### Correlaciones y covarianzas

Se procederá a estudiar las covarianzas y correlaciones de datos bivariantes.

Gráfico de covarianza entre cuatro variables que se han seleccionado por ser las más importantes nutricionalmente.


```{R}
FastFoodNutritionMenuV2 |> select(Calories, Protein..g., Total.Fat..g., Cholesterol..mg.) |>  
  drop_na() |> 
  cov() |>  
 round(4) 
``` 

Debido a que los valores de la covarianza no están normalizados, se procederá a hacer el gráfico de la correlación para facilitar la observación de las relaciones lineales:



```{r}
FastFoodNutritionMenuV2 |> select(Calories, Protein..g., Total.Fat..g., Cholesterol..mg.) |> drop_na() |> cor() |> round(2) |> corrplot(method = "ellipse", type = "lower",addCoef.col = "cyan", diag = FALSE) 
```

Como se puede observar, la correlación entre todos los valores tienen una relación lineal positiva. Siendo Colesterol-Calorías las variables que tienen menos relación lineal y GrasaTotal-Calorías las variables con más relación lineal.

  
### Gráficos en función de la compañía


En este apartado se realizan gráficos de cajas y de densidad de diferentes variables en función a la compañía a la que pertenece. 


#### Calorías


Ahora se procede a analizar un gráfico de densidad de las calorías de los productos para ver la concentración de las calorías en las diferentes compañías.


```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x = Calories, fill = Company)) + geom_density(alpha = 0.5)+labs(title = "Gráfico de densidad del número de calorías", 
       x = "Calorías (kcal)",
       y = "Densidad")+theme_bw()
```

Se observa en el gráfico que Pizza Hut concentra la mayoría de sus productos en torno a 250 kcal, que coincide con las demás compañías. 


Se va a realizar un gráfico de cajas de las calorías en función de las compañías, mostrando la distribución de datos en cuartiles, así como sus datos atípicos y promedios. Así se podrá ver mejor los datos.


```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x=Company, y=Calories))+geom_boxplot()+theme_bw()+labs(title= "Tabla de cajas (Compañía-Calorías)", y = "Calorías (kcal)",x = "Compañia")

```

Como se puede observar, la compañía más calórica es Burguer King, y la menos calórica KFC. McDonald's y KFC presentan la mayoría de casos atípicos siendo McDonald's el que tiene mayor concentración de estos. 


#### Proteínas


Se continua con un gráfico de densidad de las proteínas de los productos para ver la concentración de las proteínas en las diferentes compañías.


```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x = Protein..g., fill = Company)) + geom_density(alpha = 0.5)+labs(title = "Gráfico de densidad del número de proteínas", 
       x = "Proteína (g)",
       y = "Densidad")+theme_bw()
```

Se observa en el gráfico que la mayoría de las compañías concentran la mayoría de sus productos en torno a 15 gramos de proteína. 

Se debe mencionar que KFC tiene demasiados valores nulos, por lo que los valores menores que 5 gramos no presentan una información correcta.

Se proseguirá realizando un gráfico de cajas de las proteínas en función de las compañías.


```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x=Company, y=Protein..g.))+geom_boxplot()+theme_bw()+labs(title="Tabla de cajas (Compañía-Proteína)", y = "Proteína (g)",x = "Compañia")

```


Como se ha visto en el gráfico anterior, KFC presenta una mediana que no se corresponde a la realidad debido a que hay demasiados valores nulos.

Además, la compañía Pizza Hut tiene muy concentrado los valores, estando todo concentrado entre 5 y 20 g de proteína.


#### Grasas 


Ahora se estudiará el gráfico de densidades de las grasas de los productos.

```{r}
FastFoodNutritionMenuV2 |>
  ggplot(aes(x = Total.Fat..g., fill = Company)) + geom_density(alpha = 0.5)+labs(title = "Gráfico de densidad de los gramos de grasas", 
       x = "Grasas (g)",
       y = "Densidad")+theme_bw()
```

La mayoría de los productos se concentran en menos de 25 gramos de grasa y de los productos que superan ese límite, Burguer King es el que más productos posee.

En este gráfico también se puede ver que los valores de KFC se encuentran en su mayoría en 0, lo que se verá reflejado en el gráfico siguiente, el gráfico de cajas de la variable Total.Fat..g., es decir, de las grasas de cada producto en función de su compañía.

```{r}
FastFoodNutritionMenuV2 |>
  ggplot(aes(x=Company, y=Total.Fat..g.))+geom_boxplot()+theme_bw()+labs(title="Tabla de cajas (Compañía-Grasas)",y = "Grasas (g)",x = "Compañia")
```

Burger King es la compañía con la mayor amplitud en el numero de grasas de sus productos, y, como ya se prevenía con el gráfico anterior, muchos de los datos de KFC se pierden al tener tantos valores nulos, teniendo su mediana en 0.


#### Colesterol

```{r}
FastFoodNutritionMenuV2 |> 
  
  ggplot(aes(x = Cholesterol..mg., fill = Company)) + geom_density(alpha = 0.5)+labs(title = "Gráfico de densidad de los gramos de grasas", 
       x = "Colesterol (mg)",
       y = "Densidad")+theme_bw()
```


Con este gráfico se puede ver como la mayoría de productos tienen su colesterol en menos de 100, pero que hay unos cuantos productos de cada compañía que tienen bastante más

A continuación se muestra el gráfico de cajas de colesterol:


```{r}
FastFoodNutritionMenuV2 |> 
  ggplot(aes(x=Company, y=Cholesterol..mg.))+geom_boxplot()+theme_bw()+labs(title="Tabla de cajas (Compañía-Colesterol)", y = "Colesterol (mg)",x = "Compañia")
```

Con ello, se confirma que en esta variable se encuentran muchos casos atípicos para todas las compañías a excepción de Pizza Hut, que no tiene ninguno, unos valores que llegan a ser 500 veces mayores que la mediana de su compañía.

### Gráficos de Dispersión

Se van a realizar varios gráficos de dispersión para ver las relaciones entre las diferentes variables.


#### Calorías-Proteínas

Se comenzará haciendo un estudio de las relaciones entre las variables de proteínas y calorías, viendo en primer lugar sus ajustes de regresión en general, y prosiguiendo con un estudio más a fondo de cómo interactúan según la compañía a la que pertenezcan.


```{r}
FastFoodNutritionMenuV2 |> 
  drop_na()|>
  ggplot(aes(x = Calories, y = Protein..g.)) +
  geom_point() +
  geom_smooth() +
  labs(title = "Gráfico de dispersión con ajuste de regresión",
       x= "Calorias",
       y= "Proteínas")+theme_bw()
```

```{r}
FastFoodNutritionMenuV2 |> 
  drop_na()|>
  ggplot(aes(x = Calories, y = Protein..g.)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE) +
  labs(title = "Gráfico de dispersión con ajuste de regresión lineal",
       x= "Calorias",
       y= "Proteínas")+theme_bw()
```

Al estudiar la dispersión entre las proteínas y las calorías y al comparar el ajuste de regresión realizado en ambos gráficos, se observa de manera muy visual cómo se asemejan bastante. Es decir, el gráfico realizado en primer lugar, el cual la línea de regresión se ajusta a todos los valores dados y no se realiza en línea recta como en el siguiente, es muy parecido a una recta, no solo en la zona inicial, dónde se concentran la mayor parte de datos, sino durante toda la gráfica, manteniéndose incluso al final donde no hay apenas valores.

Con esto vemos cómo estas dos variables están muy relacionadas, pues se han obtenido unos resultados muy similares. A continuación se verá como se ve en función de las compañías, omitiendo el ajuste de regresión:


```{r}
FastFoodNutritionMenuV2 |> 
  drop_na()|>
  ggplot(aes(x = Calories, y = Protein..g., col = Company)) +
  geom_point() +
  labs(title = "Gráfico de dispersión clasificado por compañías",
       x= "Calorias",
       y= "Proteínas")+theme_bw()
```
##### Resumen del modelo lineal (Proteinas/Calorías)

```{r}
mod <- FastFoodNutritionMenuV2 |> 
  slice(1:15) |>  
  select(Protein..g., Calories) |>  
  with(lm(Protein..g. ~ Calories))  

summary(mod) 
```
Con este gráfico se puede apreciar muy bien las relaciones de cada compañía. En primer lugar se observa como Pizza Hut concentra todos sus valores al inicio, entre 500 kcal y 20 gramos de proteínas, estando muy concentrados y en línea recta. Por lo que es la compañía que posee una relación lineal más positiva. No tan concentrado como este, se puede ver como Burger King también tiene una relación bastante positiva, pero en este caso como ya se ha mencionado, se encuentran más dispersos sus valores, llegando hasta las 1250 kcal y 70 gramos de proteínas.

Wendy's y McDonald's son todavía más dispersos, pero se sigue manteniendo una relación lineal positiva en casi todos sus valores. En cambio, se puede observar como KFC y sobre todo en Taco Bell, comienzan con una relación positiva, pero cuanto más avanza más disminuye dicha relación, llegando incluso a ser una relación lineal negativa.


#### Grasa-Colesterol


Por último, se procede a analizar la relación entre las variables grasas (g) y la variable Colesterol (mg), comenzando con un estudio de la dispersión con ajustes de regresión. Después un análisis más a fondo con una regresión lineal y un estudio de cada compañía a la que pertenece.



```{r}
FastFoodNutritionMenuV2 |> 
  drop_na()|>
  ggplot(aes(x = Total.Fat..g., y = Cholesterol..mg.)) +
  geom_point() +
  geom_smooth() +
  labs(title = "Gráfico de dispersión con ajuste de regresión", 
       x = "Grasa (g)",
       y = "Colesterol (mg)")+theme_bw()
```


En este gráfico se puede observar como al principio se tiene una dispersión lineal positiva contínua, pero según se avanza en la gráfica, a partir del punto(28,100) la pendiente empieza a aumentar hasta llegar al punto (62,225). En ese punto, la gráfica cambia de dirección y comienza una dispersión de valor negativo. De modo que hasta el punto (62,225) se puede aproximar la gráfica a una recta, sin embargo después del punto se aproxima más a una parábola cóncava.



```{r}
FastFoodNutritionMenuV2 |> 
  drop_na()|>
  ggplot(aes(x = Total.Fat..g., y = Cholesterol..mg.)) +
  geom_point() +
  geom_smooth(method = lm, se = FALSE) +
   labs(title = "Gráfico de dispersión con ajuste de regresión lineal", 
       x = "Grasa (g)",
       y = "Colesterol (mg)")+theme_bw()
```

Se puede observar en esta gráfica una regresión lineal positiva constante, donde la mayor parte de los productos se encuentran en el intervalo (0,28) de la variable grasas y (0,100) de la variable Colesterol. Así que, las variables colesterol y grasa están relacionadas con una recta con pendiente positiva.


```{r}
FastFoodNutritionMenuV2 |> 
  drop_na()|>
  ggplot(aes(x = Total.Fat..g., y = Cholesterol..mg. , col= Company)) +
  geom_point() +
   labs(title = "Gráfico de dispersión calificado por compañías", 
       x = "Grasa (g)",
       y = "Colesterol (mg)")+theme_bw()
```
##### Resumen del modelo lineal (Grasa/Colesterol)
```{r}
mod <- FastFoodNutritionMenuV2 |> 
  slice(1:15) |>  
  select(Total.Fat..g., Cholesterol..mg.) |>  
  with(lm(Cholesterol..mg. ~ Total.Fat..g.)) 
summary(mod)  
```

En este otro gráfico se puede estudiar en qué intervalos de la gráfica de dispersión Grasa-Colesterol está cada compañía. Por ejemplo, se ve cómo todos los productos de Pizza Hut se encuentran encerrados en el intervalo (0,25) grasas y (0,50) colesterol, exceptuando un producto atípico que sobrepasa los 25 gramos de grasas. Por otro lado, podemos apreciar que Burger King posee el mayor número de productos dispersos de la tabla en comparación con las otras compañías. Rebasando los 80 gramos de grasa y llegando casi a los 400 mg de colesterol. Por otra parte, se aprecia que la compañía McDonald's posee los productos con más colesterol, llegando a alcanzar casi los 600 mg. Así mismo, KFC posee el producto con más grasas, consiguiendo casi los 100 gramos de grasas.


# Conclusión

A lo largo de este estudio, se ha visto la distribución de las compañías en los datos obtenidos. También las frecuencias absolutas y relativas de cada variable cuantitativa, para comprender sus frecuencias en intervalos y ver si sus valores más frecuentes están en los límites recomendados. Después se ha analizado la correlación y covarianza de las variables más importantes nutricionalmente. Y por último se han visto mediante gráficos bivariantes las relaciones lineales entre diferentes variables cuantitativas.

Sin embargo, hay unas preguntas que todavía no han sido respondidas. Esas preguntas corresponden con las planteadas en la introducción y objetivos del estudio. 

Primero de todo, se ha observado que muchos de los datos que contenía la tabla de datos utilizada, contiene valores nulos. Por este motivo, alguna compañía y gráfico pueden no reflejar datos reales. Siendo KFC la compañía con mayores datos nulos, por ello la más afectada. Por este motivo no se puede contestar correctamente las preguntas planteadas, pero se puede contestar dando una aproximación.

A pesar de todo, se ha podido llegar a la conclusión que la compañía más perjudicial para la salud ha resultado ser Burguer King. Esto es debido a que, sin ninguna duda, Burguer King ha resultado ser la compañía que más calorías y grasas totales tiene en sus productos. Los demás valores nutricionales han acabado siendo bastante parecidos con las demás compañías, por lo que no se puede decir exactamente cuál es la compañía que tiene los valores mayores. Por último, se ha comprobado que existen relaciones lineales entre los diferentes valores nutricionales como por ejemplo la grasa y el colesterol.  


